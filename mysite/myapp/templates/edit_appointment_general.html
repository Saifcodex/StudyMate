{% extends "base.html" %}
{% load static %}
{% block content%}


<!-- Main Content -->
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <!-- Page Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h2 class="fw-bold mb-0">Edit Appointment</h2>
                <a href="{% url 'user_profile' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to Profile
                </a>
            </div>

            <!-- Appointment Card -->
            <div class="card shadow-sm border-0">
                <div class="card-header bg-primary text-white py-3">
                    <h5 class="mb-0"><i class="fas fa-calendar-edit me-2"></i>Appointment Details</h5>
                </div>
                <div class="card-body p-4">
                    <form method="POST" class="needs-validation" novalidate>
                        {% csrf_token %}

                        <!-- Student Information Section -->
                        <div class="mb-4">
                            <h6 class="text-primary mb-3"><i class="fas fa-user-graduate me-2"></i>Student Information</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="studentName" class="form-label">Student Name</label>
                                    <input type="text" class="form-control" id="studentName" name="student_name"
                                           value="{{ general_appointment.student_name }}" required>
                                    <div class="invalid-feedback">
                                        Please provide student name.
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="phoneNumber" class="form-label">Phone Number</label>
                                    <input type="text" pattern="\d{5}" maxlength="5" class="form-control" id="phoneNumber" name="phone_number"
                                           value="{{ general_appointment.phone_number }}" required>
                                    <div class="invalid-feedback">
                                        Please enter a 5-digit phone number.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Guardian Information Section -->
                        <div class="mb-4">
                            <h6 class="text-primary mb-3"><i class="fas fa-user-shield me-2"></i>Guardian Information</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="guardianName" class="form-label">Guardian Name</label>
                                    <input type="text" class="form-control" id="guardianName" name="guardian_name"
                                           value="{{ general_appointment.guardian_name }}" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="guardianPhone" class="form-label">Guardian Phone</label>
                                    <input type="text" pattern="\d{5}" maxlength="5" class="form-control" id="guardianPhone" name="guardian_phone"
                                           value="{{ general_appointment.guardian_phone }}" required>
                                    <div class="invalid-feedback">
                                        Please enter a 5-digit guardian phone number.
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Class Information Section -->
                        <div class="mb-4">
                            <h6 class="text-primary mb-3"><i class="fas fa-book-open me-2"></i>Class Information</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="className" class="form-label">Class Name</label>
                                    <input type="text" class="form-control" id="className" name="class_name"
                                           value="{{ general_appointment.class_name }}" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="subject" class="form-label">Subject</label>
                                    <input type="text" class="form-control" id="subject" name="subject"
                                           value="{{ general_appointment.subject }}" required>
                                </div>
                            </div>
                        </div>

                        <!-- Location Information Section -->
                        <div class="mb-4">
                            <h6 class="text-primary mb-3"><i class="fas fa-map-marker-alt me-2"></i>Location Information</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="division" class="form-label">Division</label>
                                    <select id="division" name="division" class="form-select" required>
                                        <option value="" disabled>Select Division</option>
                                        <option value="Barishal" {% if general_appointment.division == "Barishal" %}selected{% endif %}>Barishal</option>
                                        <option value="Chattogram" {% if general_appointment.division == "Chattogram" %}selected{% endif %}>Chattogram</option>
                                        <option value="Dhaka" {% if general_appointment.division == "Dhaka" %}selected{% endif %}>Dhaka</option>
                                        <option value="Khulna" {% if general_appointment.division == "Khulna" %}selected{% endif %}>Khulna</option>
                                        <option value="Mymensingh" {% if general_appointment.division == "Mymensingh" %}selected{% endif %}>Mymensingh</option>
                                        <option value="Rajshahi" {% if general_appointment.division == "Rajshahi" %}selected{% endif %}>Rajshahi</option>
                                        <option value="Rangpur" {% if general_appointment.division == "Rangpur" %}selected{% endif %}>Rangpur</option>
                                        <option value="Sylhet" {% if general_appointment.division == "Sylhet" %}selected{% endif %}>Sylhet</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="district" class="form-label">District</label>
                                    <select id="district" name="district" class="form-select" required>
                                        <option value="" disabled>Select District</option>
                                        <option value="Barguna" {% if general_appointment.district == "Barguna" %}selected{% endif %}>Barguna</option>
                                        <option value="Barishal" {% if general_appointment.district == "Barishal" %}selected{% endif %}>Barishal</option>
                                        <option value="Bhola" {% if general_appointment.district == "Bhola" %}selected{% endif %}>Bhola</option>
                                        <option value="Jhalokati" {% if general_appointment.district == "Jhalokati" %}selected{% endif %}>Jhalokati</option>
                                        <option value="Patuakhali" {% if general_appointment.district == "Patuakhali" %}selected{% endif %}>Patuakhali</option>
                                        <option value="Pirojpur" {% if general_appointment.district == "Pirojpur" %}selected{% endif %}>Pirojpur</option>
                                        <option value="Bandarban" {% if general_appointment.district == "Bandarban" %}selected{% endif %}>Bandarban</option>
                                        <option value="Brahmanbaria" {% if general_appointment.district == "Brahmanbaria" %}selected{% endif %}>Brahmanbaria</option>
                                        <option value="Chandpur" {% if general_appointment.district == "Chandpur" %}selected{% endif %}>Chandpur</option>
                                        <option value="Chattogram" {% if general_appointment.district == "Chattogram" %}selected{% endif %}>Chattogram</option>
                                        <option value="Cumilla" {% if general_appointment.district == "Cumilla" %}selected{% endif %}>Cumilla</option>
                                        <option value="Cox's Bazar" {% if general_appointment.district == "Cox's Bazar" %}selected{% endif %}>Cox's Bazar</option>
                                        <option value="Feni" {% if general_appointment.district == "Feni" %}selected{% endif %}>Feni</option>
                                        <option value="Khagrachhari" {% if general_appointment.district == "Khagrachhari" %}selected{% endif %}>Khagrachhari</option>
                                        <option value="Lakshmipur" {% if general_appointment.district == "Lakshmipur" %}selected{% endif %}>Lakshmipur</option>
                                        <option value="Noakhali" {% if general_appointment.district == "Noakhali" %}selected{% endif %}>Noakhali</option>
                                        <option value="Rangamati" {% if general_appointment.district == "Rangamati" %}selected{% endif %}>Rangamati</option>
                                        <option value="Dhaka" {% if general_appointment.district == "Dhaka" %}selected{% endif %}>Dhaka</option>
                                        <option value="Faridpur" {% if general_appointment.district == "Faridpur" %}selected{% endif %}>Faridpur</option>
                                        <option value="Gazipur" {% if general_appointment.district == "Gazipur" %}selected{% endif %}>Gazipur</option>
                                        <option value="Gopalganj" {% if general_appointment.district == "Gopalganj" %}selected{% endif %}>Gopalganj</option>
                                        <option value="Kishoreganj" {% if general_appointment.district == "Kishoreganj" %}selected{% endif %}>Kishoreganj</option>
                                        <option value="Madaripur" {% if general_appointment.district == "Madaripur" %}selected{% endif %}>Madaripur</option>
                                        <option value="Manikganj" {% if general_appointment.district == "Manikganj" %}selected{% endif %}>Manikganj</option>
                                        <option value="Munshiganj" {% if general_appointment.district == "Munshiganj" %}selected{% endif %}>Munshiganj</option>
                                        <option value="Narayanganj" {% if general_appointment.district == "Narayanganj" %}selected{% endif %}>Narayanganj</option>
                                        <option value="Narsingdi" {% if general_appointment.district == "Narsingdi" %}selected{% endif %}>Narsingdi</option>
                                        <option value="Rajbari" {% if general_appointment.district == "Rajbari" %}selected{% endif %}>Rajbari</option>
                                        <option value="Shariatpur" {% if general_appointment.district == "Shariatpur" %}selected{% endif %}>Shariatpur</option>
                                        <option value="Tangail" {% if general_appointment.district == "Tangail" %}selected{% endif %}>Tangail</option>
                                        <option value="Bagerhat" {% if general_appointment.district == "Bagerhat" %}selected{% endif %}>Bagerhat</option>
                                        <option value="Chuadanga" {% if general_appointment.district == "Chuadanga" %}selected{% endif %}>Chuadanga</option>
                                        <option value="Jashore" {% if general_appointment.district == "Jashore" %}selected{% endif %}>Jashore</option>
                                        <option value="Jhenaidah" {% if general_appointment.district == "Jhenaidah" %}selected{% endif %}>Jhenaidah</option>
                                        <option value="Khulna" {% if general_appointment.district == "Khulna" %}selected{% endif %}>Khulna</option>
                                        <option value="Kushtia" {% if general_appointment.district == "Kushtia" %}selected{% endif %}>Kushtia</option>
                                        <option value="Magura" {% if general_appointment.district == "Magura" %}selected{% endif %}>Magura</option>
                                        <option value="Meherpur" {% if general_appointment.district == "Meherpur" %}selected{% endif %}>Meherpur</option>
                                        <option value="Narail" {% if general_appointment.district == "Narail" %}selected{% endif %}>Narail</option>
                                        <option value="Satkhira" {% if general_appointment.district == "Satkhira" %}selected{% endif %}>Satkhira</option>
                                        <option value="Jamalpur" {% if general_appointment.district == "Jamalpur" %}selected{% endif %}>Jamalpur</option>
                                        <option value="Mymensingh" {% if general_appointment.district == "Mymensingh" %}selected{% endif %}>Mymensingh</option>
                                        <option value="Netrokona" {% if general_appointment.district == "Netrokona" %}selected{% endif %}>Netrokona</option>
                                        <option value="Sherpur" {% if general_appointment.district == "Sherpur" %}selected{% endif %}>Sherpur</option>
                                        <option value="Bogra" {% if general_appointment.district == "Bogra" %}selected{% endif %}>Bogra</option>
                                        <option value="Joypurhat" {% if general_appointment.district == "Joypurhat" %}selected{% endif %}>Joypurhat</option>
                                        <option value="Naogaon" {% if general_appointment.district == "Naogaon" %}selected{% endif %}>Naogaon</option>
                                        <option value="Natore" {% if general_appointment.district == "Natore" %}selected{% endif %}>Natore</option>
                                        <option value="Chapainawabganj" {% if general_appointment.district == "Chapainawabganj" %}selected{% endif %}>Chapainawabganj</option>
                                        <option value="Pabna" {% if general_appointment.district == "Pabna" %}selected{% endif %}>Pabna</option>
                                        <option value="Rajshahi" {% if general_appointment.district == "Rajshahi" %}selected{% endif %}>Rajshahi</option>
                                        <option value="Sirajganj" {% if general_appointment.district == "Sirajganj" %}selected{% endif %}>Sirajganj</option>
                                        <option value="Dinajpur" {% if general_appointment.district == "Dinajpur" %}selected{% endif %}>Dinajpur</option>
                                        <option value="Gaibandha" {% if general_appointment.district == "Gaibandha" %}selected{% endif %}>Gaibandha</option>
                                        <option value="Kurigram" {% if general_appointment.district == "Kurigram" %}selected{% endif %}>Kurigram</option>
                                        <option value="Lalmonirhat" {% if general_appointment.district == "Lalmonirhat" %}selected{% endif %}>Lalmonirhat</option>
                                        <option value="Nilphamari" {% if general_appointment.district == "Nilphamari" %}selected{% endif %}>Nilphamari</option>
                                        <option value="Panchagarh" {% if general_appointment.district == "Panchagarh" %}selected{% endif %}>Panchagarh</option>
                                        <option value="Rangpur" {% if general_appointment.district == "Rangpur" %}selected{% endif %}>Rangpur</option>
                                        <option value="Thakurgaon" {% if general_appointment.district == "Thakurgaon" %}selected{% endif %}>Thakurgaon</option>
                                        <option value="Habiganj" {% if general_appointment.district == "Habiganj" %}selected{% endif %}>Habiganj</option>
                                        <option value="Moulvibazar" {% if general_appointment.district == "Moulvibazar" %}selected{% endif %}>Moulvibazar</option>
                                        <option value="Sunamganj" {% if general_appointment.district == "Sunamganj" %}selected{% endif %}>Sunamganj</option>
                                        <option value="Sylhet" {% if general_appointment.district == "Sylhet" %}selected{% endif %}>Sylhet</option>
                                    </select>
                                </div>
                                <div class="col-12">
                                    <label for="address" class="form-label">Address</label>
                                    <input type="text" class="form-control" id="address" name="address"
                                           value="{{ general_appointment.address }}" required>
                                </div>
                            </div>
                        </div>

                        <!-- Schedule Information Section -->
                        <div class="mb-4">
                            <h6 class="text-primary mb-3"><i class="fas fa-clock me-2"></i>Schedule Information</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label for="preferred_days" class="form-label">Preferred Days</label>
                                    <input type="text" class="form-control" id="preferred_days" name="preferred_days"
                                           value="{{ general_appointment.preferred_days }}" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="preferred_time" class="form-label">Preferred Time</label>
                                    <select id="preferred_time" name="preferred_time" class="form-control" required>
                                         <option value=""> Select Time </option>
                                        {% for time in available_time_slots %}
                                             <option value="{{ time.id }}" {% if general_appointment.preferred_time.id == time.id %}selected{% endif %}>
                                                {{ time.time|time:"h:i A" }}
                                            </option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                            <button type="submit" class="btn btn-primary px-4">
                                <i class="fas fa-save me-2"></i>Update Appointment
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
(function () {
  'use strict'


  var forms = document.querySelectorAll('.needs-validation')

  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })
})()
</script>
<script>
document.getElementById('division').addEventListener('change', function() {
    const division = this.value;
    const districtSelect = document.getElementById('district');
    districtSelect.disabled = false;
});
</script>

{% endblock %}